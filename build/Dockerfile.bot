FROM python:3.9-slim-buster@sha256:8ffb28a4fca06fc0914dac67e801cf447df0225ea23ee1b42685de02f2555235

ARG POETRY_VERSION
ENV POETRY_VERSION $POETRY_VERSION

RUN pip install poetry==$POETRY_VERSION
COPY poetry.lock pyproject.toml /tmp/
RUN cd /tmp && poetry config virtualenvs.create false && poetry install --no-dev --no-interaction

WORKDIR /bot
COPY . .

CMD ["python", "-u", "main.py"]
